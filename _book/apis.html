<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Louis Teitelbaum and Almog Simchon">
<title>Data Science for Psychology: Natural Language - 9&nbsp; Web APIs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./scraping.html" rel="next">
<link href="./corpora.html" rel="prev">
<link href="./images/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data-sources.html">Sources of Data</a></li><li class="breadcrumb-item"><a href="./apis.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Web APIs</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Psychology: Natural Language</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/rimonim/ds4psych" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction: Why Does Psychology Need Natural Language?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ethics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Ethics of Data Science in Psychology</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./data-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aesthetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Why Aesthetic Choices are Important</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./telling-a-story.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Don’t Distract From the Story</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./word-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualizing Distributions of Words</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data-viz-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Additional Resources for Data Visualization</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./data-sources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sources of Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Experiments</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./corpora.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Corpus Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./apis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Web APIs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Web Scraping</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./quantification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quantifying Psychological Properties of Text</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./look-at-your-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Look at Your Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quanteda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Quanteda</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tokenization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Tokenization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./word-counting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Dictionary-Based Word Counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dla.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Open-Vocabulary Word Counting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./word-counting-improvements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Transforming Word Counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vectorspace-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Thinking in Vector Space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decontextualized-embeddings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Bag of Words Embeddings: Decontextualized Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./contextualized-embeddings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Contextualization and Large Language Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./navigating-vectorspace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Navigating Vector Space</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linguistic-complexity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Measures of Linguistic Complexity</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./audio-video-image.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Audio, Video, and Image Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./transcription.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Transcribing Audio</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Additional Resources</span></span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#api-basic-concepts" id="toc-api-basic-concepts" class="nav-link active" data-scroll-target="#api-basic-concepts"><span class="header-section-number">9.1</span> API Basic Concepts</a>
  <ul class="collapse">
<li><a href="#vosonsml" id="toc-vosonsml" class="nav-link" data-scroll-target="#vosonsml"><span class="header-section-number">9.1.1</span> vosonSML</a></li>
  </ul>
</li>
  <li>
<a href="#reddit" id="toc-reddit" class="nav-link" data-scroll-target="#reddit"><span class="header-section-number">9.2</span> Reddit</a>
  <ul class="collapse">
<li><a href="#the-reddit-algorithm" id="toc-the-reddit-algorithm" class="nav-link" data-scroll-target="#the-reddit-algorithm"><span class="header-section-number">9.2.1</span> The Reddit Algorithm</a></li>
  <li><a href="#communities" id="toc-communities" class="nav-link" data-scroll-target="#communities"><span class="header-section-number">9.2.2</span> Communities</a></li>
  <li><a href="#sec-reddit-threads" id="toc-sec-reddit-threads" class="nav-link" data-scroll-target="#sec-reddit-threads"><span class="header-section-number">9.2.3</span> Threads</a></li>
  <li><a href="#other-reddit-features" id="toc-other-reddit-features" class="nav-link" data-scroll-target="#other-reddit-features"><span class="header-section-number">9.2.4</span> Other Reddit Features</a></li>
  </ul>
</li>
  <li>
<a href="#twitter-x" id="toc-twitter-x" class="nav-link" data-scroll-target="#twitter-x"><span class="header-section-number">9.3</span> Twitter / X</a>
  <ul class="collapse">
<li><a href="#followers-mentions-and-retweets" id="toc-followers-mentions-and-retweets" class="nav-link" data-scroll-target="#followers-mentions-and-retweets"><span class="header-section-number">9.3.1</span> Followers, Mentions, and Retweets</a></li>
  <li><a href="#geolocation-on-twitter" id="toc-geolocation-on-twitter" class="nav-link" data-scroll-target="#geolocation-on-twitter"><span class="header-section-number">9.3.2</span> Geolocation on Twitter</a></li>
  </ul>
</li>
  <li>
<a href="#mastodon" id="toc-mastodon" class="nav-link" data-scroll-target="#mastodon"><span class="header-section-number">9.4</span> Mastodon</a>
  <ul class="collapse">
<li><a href="#servers" id="toc-servers" class="nav-link" data-scroll-target="#servers"><span class="header-section-number">9.4.1</span> Servers</a></li>
  <li><a href="#sec-mastodon-threads" id="toc-sec-mastodon-threads" class="nav-link" data-scroll-target="#sec-mastodon-threads"><span class="header-section-number">9.4.2</span> Threads</a></li>
  <li><a href="#other-mastodon-features" id="toc-other-mastodon-features" class="nav-link" data-scroll-target="#other-mastodon-features"><span class="header-section-number">9.4.3</span> Other Mastodon Features</a></li>
  </ul>
</li>
  <li>
<a href="#youtube" id="toc-youtube" class="nav-link" data-scroll-target="#youtube"><span class="header-section-number">9.5</span> YouTube</a>
  <ul class="collapse">
<li><a href="#video-comments" id="toc-video-comments" class="nav-link" data-scroll-target="#video-comments"><span class="header-section-number">9.5.1</span> Video Comments</a></li>
  </ul>
</li>
  <li><a href="#sec-other-apis" id="toc-sec-other-apis" class="nav-link" data-scroll-target="#sec-other-apis"><span class="header-section-number">9.6</span> Other Web APIs</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/rimonim/ds4psych/blob/main/apis.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/rimonim/ds4psych/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-apis" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Web APIs</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In <a href="corpora.html"><span>Chapter&nbsp;8</span></a>, we listed numerous placed to find datasets online. The sorts of datasets discussed there are generally formatted as a .csv file—or something like it—which you can download directly to your computer and import into R using <code>read_csv()</code>. Lots of online data, however, are not pre-packaged in this way. When datasets are very large or complex, or are being updated regularly, the hosts of the data will instead provide a <strong>web API</strong>.</p>
<p>You can think of web APIs as little programming languages that are written inside a URL (URLs are the things you write in the top of your web browser to tell it which web page you want to access). When you access your custom-written URL, the host will perform whatever computations are necessary to get you your data, and send it to you in the same way that it would send you a website.</p>
<p>Web APIs are sometimes difficult to use because each one works differently. Learning to use a new API can be like learning a new programming language. For this reason, web APIs sometimes have associated <strong>wrappers</strong>, packages that allow you to communicate with the API in a more familiar format.</p>
<p>In the first part of this chapter, we introduce the <a href="https://github.com/vosonlab/vosonSML"><code>vosonSML</code> package</a>, an R-friendly wrapper that provides easy access to the Reddit, Twitter, Mastadon, and YouTube APIs. At the end of the chapter, we will discuss web APIs that do not have a convenient wrapper in R.</p>
<section id="api-basic-concepts" class="level2" data-number="9.1"><h2 data-number="9.1" class="anchored" data-anchor-id="api-basic-concepts">
<span class="header-section-number">9.1</span> API Basic Concepts</h2>
<ul>
<li>
<strong>Requests:</strong> Each time you visit a URL associated with an API, you are submitting a <em>request</em> for data.</li>
<li>
<strong>Endpoints:</strong> Every API has at least one <em>endpoint</em>, a contact point for particular types of requests.</li>
<li>
<strong>Rate Limits:</strong> Many APIs set limits on the number of requests you can make per minute (or per second). This is because processing requests costs time and money for the host. If you go beyond the rate limit, the API will return an error like <em>“429 Too Many Requests.”</em>
</li>
<li>
<strong>Authentication:</strong> Some APIs are not open to the public, instead requiring users to apply for access or pay for a subscription. When accessing these APIs, you need an <em>API key</em> or an <em>access token</em>. This is your password for the API.</li>
</ul>
<section id="vosonsml" class="level3" data-number="9.1.1"><h3 data-number="9.1.1" class="anchored" data-anchor-id="vosonsml">
<span class="header-section-number">9.1.1</span> vosonSML</h3>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vosonlab/vosonSML">vosonSML</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For accessing social media APIs with <code>vosonSML</code>, you only need two functions:</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/vosonSML/man/Authenticate.html">Authenticate()</a></code> creates a credential object that contains any keys or access tokens needed to access a particular API. This credential object can be reused as long as your credentials don’t change.</li>
<li>
<code><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect()</a></code> initiates a series of API requests and stores the results as a dataframe or list of dataframes.</li>
</ul>
<p><code>vosonSML</code> also provides tools for working with network data (i.e.&nbsp;the ways in which users or posts are connected to one another), but these will not be covered in this textbook.</p>
</section></section><section id="reddit" class="level2" data-number="9.2"><h2 data-number="9.2" class="anchored" data-anchor-id="reddit">
<span class="header-section-number">9.2</span> Reddit</h2>
<p>Reddit <a href="https://www.statista.com/statistics/1319008/reddit-content-created/">generated over 3 billion posts and comments in 2022</a>. Many of these contain long-form text. And its API is free. These traits make it very useful to researchers.</p>
<p>Reddit content exists on three levels:</p>
<ul>
<li>
<strong>Communities</strong>, called “subreddits” are spaces for users to post about a specific topic. Individual subreddits are referred to as “r/SUBREDDIT”. For example, <a href="https://www.reddit.com/r/dataisbeautiful/">r/dataisbeautiful</a> is for data visualizations, <a href="https://www.reddit.com/r/NaturalLanguage/">r/NaturalLanguage</a> is for posts about natural language processing, and <a href="https://www.reddit.com/r/SampleSize/">r/SampleSize</a> is a place to gather volunteer participants for surveys and polls. Communities are policed by <em>moderators</em>, users who can remove posts or ban other users from the community.</li>
<li>
<strong>Posts</strong> are posted by users to a particular subreddit. Each post has a <strong>title</strong>, which is always text, and <strong>content</strong>, which can contain text, images, and videos.</li>
<li>
<strong>Comments</strong> are responses to posts, responses to responses to posts, responses to responses to responses to posts, etc. These are always text.</li>
</ul>
<section id="the-reddit-algorithm" class="level3" data-number="9.2.1"><h3 data-number="9.2.1" class="anchored" data-anchor-id="the-reddit-algorithm">
<span class="header-section-number">9.2.1</span> The Reddit Algorithm</h3>
<p>Reddit data are not representative samples of the global population. They are not even representative samples of Reddit users. This is partly due to the dynamics of the Reddit ranking algorithm, which gives precedent to viral content. The details of the algorithm are <a href="https://medium.com/hacking-and-gonzo/how-reddit-ranking-algorithms-work-ef111e33d0d9">no longer public</a>, but it is largely based on “upvotes” and “downvotes” from the community, and probably also incorporates the time since posting. The ranking system for comments is almost certainly different from the ranking system for posts. Reddit also has a “Karma” system, by which users who post popular content get subsequent content boosted. This creates an incentive system which is <a href="https://www.reddit.com/r/ModSupport/comments/162p502/why_is_reddit_doing_nothing_to_handle_the_obvious/">sometimes exploited by the advertising industry</a>. The bottom line: <strong>Reddit posts are disproportionately viral</strong>. To partially counteract this when gathering Reddit data, set the API to sort by recency (<code>sort = "new"</code>) rather than the default, “best” (<a href="#sec-reddit-threads"><span>Section&nbsp;9.2.3</span></a>).</p>
</section><section id="communities" class="level3" data-number="9.2.2"><h3 data-number="9.2.2" class="anchored" data-anchor-id="communities">
<span class="header-section-number">9.2.2</span> Communities</h3>
<p>To retrieve the posts from a Reddit community, call <code>Authenticate("reddit")</code> followed by <code><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect()</a></code> with <code>endpoint = "listing"</code>. To specify the particular community (or communities) in which you are interested, use the <code>subreddits</code> parameter. For example, the following code retrieves the 20 most recent posts from r/RedditAPIAdvocacy, a subreddit devoted to fighting restriction of the Reddit API.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">APIAdvocacy_posts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Authenticate.html">Authenticate</a></span><span class="op">(</span><span class="st">"reddit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect</a></span><span class="op">(</span></span>
<span>    endpoint <span class="op">=</span> <span class="st">"listing"</span>, </span>
<span>    subreddits <span class="op">=</span> <span class="st">"RedditAPIAdvocacy"</span>,</span>
<span>    sort <span class="op">=</span> <span class="st">"new"</span>,   <span class="co"># newest posts first</span></span>
<span>    period <span class="op">=</span> <span class="st">"all"</span>, <span class="co"># all time</span></span>
<span>    max <span class="op">=</span> <span class="fl">20</span>,       <span class="co"># 20 most recent posts</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">APIAdvocacy_posts</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 111</span></span>
<span><span class="co">#&gt;   approved_at_utc subreddit      selftext author_fullname saved mod_reason_title</span></span>
<span><span class="co">#&gt;   &lt;lgl&gt;           &lt;chr&gt;          &lt;chr&gt;    &lt;chr&gt;           &lt;lgl&gt; &lt;lgl&gt;           </span></span>
<span><span class="co">#&gt; 1 NA              RedditAPIAdvo… ""       t2_8uyouiqz     FALSE NA              </span></span>
<span><span class="co">#&gt; 2 NA              RedditAPIAdvo… ""       t2_177u1k       FALSE NA              </span></span>
<span><span class="co">#&gt; 3 NA              RedditAPIAdvo… ""       t2_g0y5d        FALSE NA              </span></span>
<span><span class="co">#&gt; 4 NA              RedditAPIAdvo… "Last w… t2_177u1k       FALSE NA              </span></span>
<span><span class="co">#&gt; # ℹ 105 more variables: gilded &lt;int&gt;, clicked &lt;lgl&gt;, title &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   link_flair_richtext &lt;list&gt;, subreddit_name_prefixed &lt;chr&gt;, hidden &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   pwls &lt;lgl&gt;, link_flair_css_class &lt;lgl&gt;, downs &lt;int&gt;,</span></span>
<span><span class="co">#&gt; #   thumbnail_height &lt;lgl&gt;, top_awarded_type &lt;lgl&gt;, hide_score &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   name &lt;chr&gt;, quarantine &lt;lgl&gt;, link_flair_text_color &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   upvote_ratio &lt;dbl&gt;, author_flair_background_color &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   subreddit_type &lt;chr&gt;, ups &lt;int&gt;, total_awards_received &lt;int&gt;, …</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To psychology researchers, the most interesting subreddits are often those devoted to psychological disorders, for example r/depression, r/socialanxiety, r/SuicideWatch, r/bipolarreddit, and r/opiates. Subreddits devoted to intellectual discussion, such as r/changemyview, r/IAmA, and r/ExplainLikeImFive, are also interesting subjects for research. Lastly, much research is devoted to the behavior of Redditors in political communities.</p>
<p><strong>An example of using Reddit’s political communities in research:</strong> In a series of experiments, <span class="citation" data-cites="ashokkumar_pennebaker_2022">Ashokkumar &amp; Pennebaker (<a href="#ref-ashokkumar_pennebaker_2022" role="doc-biblioref">2022</a>)</span> used the Reddit API and other sources to develop a dictionary-based measure of group identity strength. A dictionary is a list of words associated with a given psychological or other construct, for example associating “sleepy” and “down” with depression (see <a href="word-counting.html"><span>Chapter&nbsp;14</span></a>). Ashokkumar and Pennebaker had participants write small, free-form responses and fill out questionnaires on group identity strength. They then identified existing dictionaries that were associated with the questionnaire-based measures, and used these to construct a composite measure of group identity strength. When applied to text, they called this measure “unquestioning affiliation.” Among college students, they showed that unquestioning affiliation in writing could predict whether students would drop out of college one year later. Finally, they applied their method to naturalistic data retrieved from the Reddit API, from the political communities r/The_Donald and r/hillaryclinton, and showed that users’ unquestioning affiliation predicted the duration that they would stay in the community before leaving.</p>
</section><section id="sec-reddit-threads" class="level3" data-number="9.2.3"><h3 data-number="9.2.3" class="anchored" data-anchor-id="sec-reddit-threads">
<span class="header-section-number">9.2.3</span> Threads</h3>
<p>A post with all of its associated comments is called a <strong>thread</strong>. For example, Hadley Wickham, the founder of <a href="https://www.tidyverse.org">the tidyverse</a>, ran a thread on the r/dataisbeautiful subreddit in 2015, in which he answered commenters’ questions. To retrieve that thread, first find its URL. Do this by finding the threat on Reddit and copying the link from your web browser. Then call <code>Authenticate("reddit")</code> and <code><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect()</a></code>, like so:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># List of thread urls (in this case only one)</span></span>
<span><span class="va">threads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"https://www.reddit.com/r/dataisbeautiful/comments/3mp9r7/im_hadley_wickham_chief_scientist_at_rstudio_and/"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Retrieve the data</span></span>
<span><span class="co">## Since the Reddit API is open, we don't need</span></span>
<span><span class="co">## to give any passwords to Authenticate()</span></span>
<span><span class="va">hadley_threads</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Authenticate.html">Authenticate</a></span><span class="op">(</span><span class="st">"reddit"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect</a></span><span class="op">(</span></span>
<span>    threadUrls <span class="op">=</span> <span class="va">threads</span>, </span>
<span>    sort <span class="op">=</span> <span class="st">"new"</span>, <span class="co"># newest comments first</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># give updates while running</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Peak at Hadley's responses</span></span>
<span><span class="va">hadley_threads</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">user</span> <span class="op">==</span> <span class="st">"hadley"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">structure</span>, <span class="va">comment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 2</span></span>
<span><span class="co">#&gt;   structure comment                                                             </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;     &lt;chr&gt;                                                               </span></span>
<span><span class="co">#&gt; 1 4_1       "1.  Should be out early next year \n\n2. Unfortunately not. \n\n3.…</span></span>
<span><span class="co">#&gt; 2 6_1       "I'm not aware of any discussions, but I'm not that likely to be si…</span></span>
<span><span class="co">#&gt; 3 7_1       "They already do occur in most errors (or at least in the `tracebac…</span></span>
<span><span class="co">#&gt; 4 10_1      "No, but the next version features customisable keyboard short cuts…</span></span>
<span><span class="co">#&gt; 5 12_1      "I offered to help the department with the overall design of stat40…</span></span>
<span><span class="co">#&gt; 6 13_1      "ggplot worked using function composition instead of addition. So i…</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The resulting dataframe has many columns. The most useful are the following:</p>
<ul>
<li>
<code>comment</code> is the text of the comment itself.</li>
<li>
<code>user</code> is user who posted the comment.</li>
<li>
<code>structure</code> is the tree structure leading to the comment. For example, “137_6_2” is the 2nd comment on the 6th comment on the 137th comment on the original post.</li>
<li>
<code>comm_date</code> is the date and time of the comment, in UTC. Since this is in character format, it needs to be converted to a datetime with <code><a href="https://lubridate.tidyverse.org/reference/as_date.html">lubridate::as_datetime()</a></code>.</li>
</ul>
<p>By processing the <code>structure</code> values, we can conceptualize the thread as a tree, with the original post as the root and comments as branches:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">hadley_threads</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    level <span class="op">=</span> <span class="fu">str_count</span><span class="op">(</span><span class="va">structure</span>, <span class="st">"_"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1L</span>,</span>
<span>    parent <span class="op">=</span> <span class="fu">str_remove</span><span class="op">(</span><span class="va">structure</span>, <span class="st">"_[[:digit:]]+$"</span><span class="op">)</span>,</span>
<span>    parent <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">level</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"0"</span>, <span class="va">parent</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">parent</span>, <span class="va">structure</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidygraph</span><span class="fu">::</span><span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html">as_tbl_graph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">'tree'</span>, circular <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_diagonal.html">geom_edge_diagonal</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.2</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"orangered"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="apis_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p><strong>An example of using Reddit threads in research:</strong> <span class="citation" data-cites="xiao_mensah_2022">Xiao &amp; Mensah (<a href="#ref-xiao_mensah_2022" role="doc-biblioref">2022</a>)</span> collected threads from r/changemyview, a community in which the original poster (OP) makes a claim, commenters make arguments against that claim, and the OP responds with “delta points” to indicate how much their view has been changed. <span class="citation" data-cites="xiao_mensah_2022">Xiao &amp; Mensah (<a href="#ref-xiao_mensah_2022" role="doc-biblioref">2022</a>)</span> analyzed the frequency of delta points at each level of the thread tree, and found that the OP’s view tended to change most after the 2nd, 4th, 6th, 8th, and 10th levels of comments—in other words, every other level. They then analyzed the semantic similarity between comments using cosine similarity (<a href="vectorspace-intro.html#sec-cosine-similarity"><span>Section&nbsp;17.1.2</span></a>) between simple word counts. The results suggested that every-other-level comments tend to elaborate and refine the comments immediately before them, so that the latter are perceived to be more persuasive.</p>
</section><section id="other-reddit-features" class="level3" data-number="9.2.4"><h3 data-number="9.2.4" class="anchored" data-anchor-id="other-reddit-features">
<span class="header-section-number">9.2.4</span> Other Reddit Features</h3>
<p>For most applications, <code>vosonSML</code> is a sufficient Reddit API wrapper. For slightly more advanced functionality like searching for subreddits with a keyword or retrieving a user’s comment history, we recommend <a href="https://github.com/ivan-rivera/RedditExtractor">Reddit Extractor</a>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advantages of Reddit Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Explicit Communities:</strong> Reddit communities are clearly defined and explicit about their purposes. Reddit includes communities devoted to fictional storytelling, factual storytelling, personal reflection, technical advice, political discussion, joke telling, and much more. This makes it easy to gather a domain-specific sample.</li>
<li>
<strong>Long-form Text Responses:</strong> While some social media platforms have character limits for posts or comments, Reddit has many communities devoted to long-form text. Longer documents can make characterization of their content more accurate.</li>
<li>
<strong>Anonymity:</strong> Reddit users can remain relatively anonymous, which might encourage more honest and open sharing of experiences.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Disadvantages of Reddit Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Selection Bias:</strong> Certain subreddits may attract specific demographics, leading to potential selection bias in the data.</li>
<li>
<strong>Anonymity:</strong> In some cases, anonymity may make user behavior less representative. For example, many users have multiple accounts, which they use for different activities on the platform, making users seem disproportionately narrow in their interests.</li>
</ul>
</div>
</div>
</section></section><section id="twitter-x" class="level2" data-number="9.3"><h2 data-number="9.3" class="anchored" data-anchor-id="twitter-x">
<span class="header-section-number">9.3</span> Twitter / X</h2>
<p>Twitter has been called the “model organism” of big data research <span class="citation" data-cites="tufekci_2014">(<a href="#ref-tufekci_2014" role="doc-biblioref">Tufekci, 2014</a>)</span>. This is because, until 2023, Twitter was the largest source of free, open social text data. In contrast to Facebook, almost all Twitter activity is public. Twitter’s standardized character limit (originally 140, now 280), along with its simple network structure, make structuring and analyzing the data easy.</p>
<section id="followers-mentions-and-retweets" class="level3" data-number="9.3.1"><h3 data-number="9.3.1" class="anchored" data-anchor-id="followers-mentions-and-retweets">
<span class="header-section-number">9.3.1</span> Followers, Mentions, and Retweets</h3>
<p>Whereas Reddit users subscribe to communities, Twitter users subscribe to other users. This is called “following.” They can also “retweet” other users’ posts to their own feed, or explicitly mention other users in posts using the “@” symbol. This focus on connections between individuals means that each user’s communal associations can be characterized in a rich, nuanced way.</p>
<p><strong>An example of using Twitter networks in research:</strong> <span class="citation" data-cites="mosleh_etal_2021">Mosleh et al. (<a href="#ref-mosleh_etal_2021" role="doc-biblioref">2021</a>)</span> collected Twitter IDs of participants who filled out a set of questions with intuitively compelling but incorrect answers, testing analytic thinking. They then analyzed the Twitter accounts that each participant followed, and found a large cluster of accounts followed preferentially by people with less analytic thinking. This group most prominently featured Twitter accounts of retail brands.</p>
</section><section id="geolocation-on-twitter" class="level3" data-number="9.3.2"><h3 data-number="9.3.2" class="anchored" data-anchor-id="geolocation-on-twitter">
<span class="header-section-number">9.3.2</span> Geolocation on Twitter</h3>
<p>Twitter allows users to specify a geographical location along their post. While these user-provided locations can sometimes be difficult to interpret, they allow analyses by geographic location.</p>
<p><strong>An example of using Twitter geolocation in research:</strong> <span class="citation" data-cites="takhteyev_etal_2012">Takhteyev et al. (<a href="#ref-takhteyev_etal_2012" role="doc-biblioref">2012</a>)</span> used Twitter’s public feed to gather a sample of users. Researchers also collected the profiles of all the users followed by the users in the original sample. They then analyzed the distribution of these ties over geographical distance, national boundaries, and language differences. They found that Twitter users are most strongly tied to people in their own city, and that between regions, the number of airline flights was the best predictor of ties.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advantages of Twitter Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Character Limit:</strong> Twitter’s character limit means that Tweets vary less in their length. This can decrease variance in measurements.</li>
<li>
<strong>Pure Network Structure:</strong> As opposed to Reddit’s distinct communities and hierarchical comment trees, Twitter has a network-like social structure in which users are linked to other individual users or posts. This structure can reveal underlying communities and the strength of the connections between them.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Disadvantages of Twitter Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Character Limit:</strong> The character limit on tweets may limit the depth of responses and the ability to convey complex psychological experiences. The smaller sample of words in each document can also make measurement less reliable.</li>
<li>
<strong>Limited Context:</strong> Tweets may lack context, making it challenging to fully understand the meaning behind short messages.</li>
<li>
<strong>No more free API:</strong> While lots of historical Twitter data are available on the internet (see <a href="corpora.html"><span>Chapter&nbsp;8</span></a>), <a href="https://www.wired.com/story/twitter-data-api-prices-out-nearly-everyone/">the API has been prohibitively expensive since 2023</a>.</li>
</ul>
</div>
</div>
</section></section><section id="mastodon" class="level2" data-number="9.4"><h2 data-number="9.4" class="anchored" data-anchor-id="mastodon">
<span class="header-section-number">9.4</span> Mastodon</h2>
<p>In some ways, you can think of Mastodon as open source Twitter. Indeed, a large portion of the Mastodon user base started using it as a replacement for Twitter after <a href="https://en.wikipedia.org/wiki/Mastodon_(social_network)#2022_Twitter-related_spikes_in_adoption">controversial events in 2022</a>. Like Twitter users, Mastodon users post short posts to their feed, in which they can mention other users with “@” or use hashtags with “#.” Like Twitter users, Mastodon users can follow other users and be followed by them.</p>
<p>Despite their similarities, networks of users on Mastodon and Twitter are not the same. The biggest difference is that each Mastodon user is associated with a <em>server</em> (also known as an <em>instance</em>). Mastodon servers can have hundreds of thousands of users, or just a few. Each server runs the Mastodon source code independently and hosts all of its users’ content. Many servers have a theme based on a specific interest. It is also common for servers to be based around a particular locality, region, ethnicity, or country. For example, <a href="https://tech.lgbt">tech.lgbt</a> is for LGBTQIA+ technologists, <a href="https://sfba.social">SFBA.social</a> is for the San Francisco Bay Area in California, and <a href="https://fediscience.org">fediscience.org</a> is for active scientists.</p>
<p>Because of their topic-specific organization, Mastodon servers can function a bit like Reddit communities. Like Reddit communities, Mastodon servers can set their own rules for content. They can even change the default 500-character limit. The key difference is that on Reddit, <em>posts</em> are associated with a community, whereas on Mastodon, <em>users</em> are associated with a community. In other words, community affiliation on Mastodon is less related to the content of its posts and more related to the identity of its users. This feature can be useful when collecting user activity. For example, if we wanted to study the overall behavior of members of the LGBTQIA+ community, we could collect the activity of users affiliated with the <a href="https://tech.lgbt">tech.lgbt</a> and other community-specific servers.</p>
<section id="servers" class="level3" data-number="9.4.1"><h3 data-number="9.4.1" class="anchored" data-anchor-id="servers">
<span class="header-section-number">9.4.1</span> Servers</h3>
<p>Mastodon server feeds are organized chronologically (unlike Reddit or Twitter, which have complex ordering algorithms). To retrieve the most recent posts on a particular server using <code>vosonSML</code>, we call <code>Authenticate("mastodon")</code> followed by <code><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect()</a></code> with the “search” endpoint. The name of the server is identified with “instance.”</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mast_science</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Authenticate.html">Authenticate</a></span><span class="op">(</span><span class="st">"mastodon"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect</a></span><span class="op">(</span></span>
<span>    endpoint <span class="op">=</span> <span class="st">"search"</span>,</span>
<span>    instance <span class="op">=</span> <span class="st">"fediscience.org"</span>,</span>
<span>    local <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    numPosts <span class="op">=</span> <span class="fl">100</span>, <span class="co"># number of most recent posts</span></span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The global feed (i.e.&nbsp;across all servers) can be accessed by setting <code>local = FALSE</code>. You can also retrieve posts with a specific hashtag using the <code>hashtag</code> parameter (e.g.&nbsp;<code>hashtag = "rstats"</code>).</p>
<p>In all cases, the call results in a list of two dataframes, “posts” and “users.” In the “posts” dataframe we have columns such as:</p>
<ul>
<li>
<code>content.text</code> is the text of the post itself.</li>
<li>
<code>account</code> is a column of one-row dataframes containing information about the user who posted each post. You can convert this into a simple account ID column with <code>mutate(account_id = sapply(account, function(c) pull(c,id)))</code>.</li>
<li>
<code>id</code> is a unique ID for the post.</li>
<li>
<code>in_reply_to_id</code> is the ID of the post that this post is directly responding to. This can be used to build tree structures, as we did in <a href="#sec-reddit-threads"><span>Section&nbsp;9.2.3</span></a>, but see <a href="#sec-mastodon-threads"><span>Section&nbsp;9.4.2</span></a> for an alternative way to do this.</li>
<li>
<code>in_reply_to_account_id</code> is the account ID of the poster to whom this post is directly responding. This can be used to build networks of users as opposed to networks of threads.</li>
<li>
<code>created_at</code> is the date and time of the post in UTC, already in datetime format.</li>
</ul>
<p>The “users” dataframe has the same information as the <code>account</code> column of “posts”, but formatted as a single dataframe with one row per user.</p>
</section><section id="sec-mastodon-threads" class="level3" data-number="9.4.2"><h3 data-number="9.4.2" class="anchored" data-anchor-id="sec-mastodon-threads">
<span class="header-section-number">9.4.2</span> Threads</h3>
<p>Since Mastodon users can mark their posts as a reply to an earlier post, these posts are essentially “comments” on the original post. A chain of posts that reply to an original post is called a thread. We can collect the contents of one or more threads with <code>endpoint = "thread"</code>, by specifying the URL of the first post in the thread with <code>threadUrls</code>. For example, we can retrieve <a href="https://fediscience.org/@almogsi/110513658753942590">a thread by one the authors of this book, Almog</a>:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">almog_thread</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Authenticate.html">Authenticate</a></span><span class="op">(</span><span class="st">"mastodon"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect</a></span><span class="op">(</span></span>
<span>    endpoint <span class="op">=</span> <span class="st">"thread"</span>,</span>
<span>    threadUrls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"https://fediscience.org/@almogsi/110513658753942590"</span><span class="op">)</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">almog_thread</span><span class="op">$</span><span class="va">posts</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">created_at</span>, <span class="va">content.text</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="other-mastodon-features" class="level3" data-number="9.4.3"><h3 data-number="9.4.3" class="anchored" data-anchor-id="other-mastodon-features">
<span class="header-section-number">9.4.3</span> Other Mastodon Features</h3>
<p>For most applications, <code>vosonSML</code> is a sufficient Mastodon API wrapper. For slightly more advanced functionality like searching accounts or retrieving a user’s follows and followers, we recommend <a href="https://gesistsa.github.io/rtoot/">rtoot</a>.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advantages of Mastodon Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Free:</strong> Because Mastodon’s servers are decentralized (i.e.&nbsp;there is no single company controlling its operation), there is no concern that its data will become unavailable.</li>
<li>
<strong>No Feed Algorithm:</strong> Mastodon does not use a black-box algorithm to decide what users see on their feed. Users have total control over their own subscriptions (e.g.&nbsp;users who follow more accounts have more content on their feeds). This eliminates a possible confounding factor present in many social media platforms.</li>
<li>
<strong>Domain-Specific Servers:</strong> Users are associated with a particular server, often associated with an identity or region. This allows more targeted data collection.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Disadvantages of Mastodon Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Sampling Bias:</strong> Because Mastodon is largely populated by users who fled from Twitter or Facebook, their demographics may be especially unrepresentative.</li>
<li>
<strong>Smaller User Base:</strong> Mastodon has a much smaller user base compared to major platforms like Twitter and Reddit.</li>
</ul>
</div>
</div>
</section></section><section id="youtube" class="level2" data-number="9.5"><h2 data-number="9.5" class="anchored" data-anchor-id="youtube">
<span class="header-section-number">9.5</span> YouTube</h2>
<p>YouTube is structurally similar to Twitter in that neither users nor posts are explicitly associated with a community. Users subscribe directly to other users’ channels. Each user can upload posts to their own channel. As on Reddit, these posts generally have a title, a description, and a space for comments.</p>
<p>YouTube is different from other social media platforms in a few ways. Most obviously, posts consist primarily of videos. This means that analyzing a post’s description will not give an accurate representation of the post’s content. Analyzing the content of the video directly is generally impossible, since YouTube does not allow videos to be downloaded through their API. One possible workaround uses YouTube’s automatically generated video transcriptions—though YouTube does not allow access to full transcriptions for standard API key bearers, there are <a href="https://github.com/jdepoix/youtube-transcript-api">some workarounds available</a>. Nevertheless, we will limit ourselves here to text data. This primarily consists of comments on videos.</p>
<section id="video-comments" class="level3" data-number="9.5.1"><h3 data-number="9.5.1" class="anchored" data-anchor-id="video-comments">
<span class="header-section-number">9.5.1</span> Video Comments</h3>
<p>Another important difference between YouTube and other social media platforms is in the structure of the comments. Whereas Reddit comments (or Twitter/Mastodon threads) can respond one to another, generating a deep tree-like structure, YouTube comments have only two levels of depth. In other words, comments either respond directly to a video (top-level) or they respond to a top-level comment (level two). This feature can sometimes make conversations hard to track, since level two comments may be responding to another level two comment, even if they are not explicitly marked as such. On the other hand, this feature may constrain YouTube comments to respond more directly to the video.</p>
<p>The interpretation of YouTube comments as direct responses to the original video is enhanced by the rich video format of the stimulus, which likely draws users in more than a text-only post would <span class="citation" data-cites="yadav_etal_2011">(cf. <a href="#ref-yadav_etal_2011" role="doc-biblioref">Yadav et al., 2011</a>)</span>. For this reason, YouTube can be a good platform for studying responses to shared stimuli in a social context.</p>
<p>To access the the YouTube API, you will need an API key. You can get an API key in a matter of seconds by <a href="https://www.youtube.com/watch?v=of0nzBJrT20">registering your project with Google cloud</a>. Once you have the key, you can access the API through <code>vosonSML</code> by calling <code>youtube_auth &lt;- Authenticate("youtube", apiKey = "xxxxxxxxxxxxxx")</code>, followed by <code><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect()</a></code>. In the code below, we’ll collect the comments on <a href="https://youtu.be/aircAruvnKk?si=XKJeVfrB2GGrBx3H">3Blue1Brown’s excellent explanation of deep learning algorithms</a>.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># retrieve youtube_auth from separate R script </span></span>
<span><span class="co"># (so as not to publicize my key)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"~/Projects/sandbox/youtube_auth.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this could also be a vector of URLs</span></span>
<span><span class="va">video_url</span> <span class="op">&lt;-</span> <span class="st">"https://www.youtube.com/watch?v=aircAruvnKk"</span></span>
<span></span>
<span><span class="co"># collect comments</span></span>
<span><span class="va">deep_learning_comments</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">youtube_auth</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vosonSML/man/Collect.html">Collect</a></span><span class="op">(</span>videoIDs <span class="op">=</span> <span class="va">video_url</span>,</span>
<span>          maxComments <span class="op">=</span> <span class="fl">100</span>,</span>
<span>          verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This call results in a dataframe with many columns, including the following:</p>
<ul>
<li>
<code>Comment</code> is the text of the comment itself.</li>
<li>
<code>AuthorDisplayName</code> is the username of the commenter.</li>
<li>
<code>AuthorChannelUrl</code> is the URL for the commenter’s own channel.</li>
<li>
<code>PublishedAt</code> is the date and time of the comment, in UTC. Since this is in character format, it needs to be converted to a datetime with <code><a href="https://lubridate.tidyverse.org/reference/as_date.html">lubridate::as_datetime()</a></code>.</li>
<li>
<code>CommentID</code> is a unique ID for the comment.</li>
<li>
<code>ParentID</code> is the ID of the comment to which this comment is responding.</li>
</ul>
<p>If we visualize these comments like we visualized the Reddit comments in <a href="#sec-reddit-threads"><span>Section&nbsp;9.2.3</span></a>, we see that the tree has only two levels:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">deep_learning_comments</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">ParentID</span>, <span class="va">CommentID</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidygraph</span><span class="fu">::</span><span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html">as_tbl_graph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">'tree'</span>, circular <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_diagonal.html">geom_edge_diagonal</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.2</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggraph</span><span class="fu">::</span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="st">"orangered"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="apis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p><strong>An example of using YouTube comments in research:</strong> <span class="citation" data-cites="rosenbusch_etal_2019">Rosenbusch et al. (<a href="#ref-rosenbusch_etal_2019" role="doc-biblioref">2019</a>)</span> collected comments from 20 vlogs each from 110 vloggers on YouTube, along with the transcripts of those videos. They used dictionary-based word counts (<a href="word-counting.html"><span>Chapter&nbsp;14</span></a>) to measure the emotional content of both video transcripts and video comments. Using a multilevel model, they found that both video- and channel-level emotional content independently predict commenter emotions.</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advantages of YouTube Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Rich Stimuli:</strong> YouTube videos are extended and multimodal (i.e.&nbsp;they include both audio and visual stimuli). Video comments can be usefully construed as responses to that stimulus.</li>
<li>
<strong>Constrained Structure:</strong> YouTube limits its comment trees to two levels, which can simplify analyses.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Disadvantages of YouTube Data
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<strong>Missing Context:</strong> YouTube comments respond to videos. Since videos are generally unavailable for download and are in any case of a different medium than text-based comments, measuring the relationship between a comment and the video it refers to can be difficult.</li>
<li>
<strong>Constrained Structure:</strong> Because YouTube limits its comment trees to two levels, complex referential structures can be difficult to decode.</li>
</ul>
</div>
</div>
</section></section><section id="sec-other-apis" class="level2" data-number="9.6"><h2 data-number="9.6" class="anchored" data-anchor-id="sec-other-apis">
<span class="header-section-number">9.6</span> Other Web APIs</h2>
<p>In this chapter, we have covered four social media platforms and—with the exception of Twitter—how to access their APIs using <code>vosonSML</code>. Nevertheless, this has been far from an exhaustive list of social media platforms that provide APIs. <a href="https://en.wikipedia.org/wiki/Comparison_of_microblogging_and_similar_services">Many other sources of data exist</a>, each with their own advantages and disadvantages. Many of these do not have custom R wrappers for their APIs, but reading a little API documentation shouldn’t deter you from finding your ideal dataset. The following are some of our favorite sources of psychologically interesting data accessible with public APIs.</p>
<ul>
<li>
<a href="https://stackexchange.com">StackExchange</a> is a network of question-and-answer sites like StackOverflow (for programmers), MathOverflow (for mathematicians), Arqade (for videogamers), Cross Validated (for statistics and machine learining), Science Fiction &amp; Fantasy (for fans) and <a href="https://stackexchange.com/sites?view=list#users">many more</a>. StackExchange provides <a href="https://api.stackexchange.com/docs">a public API</a> for retrieving questions, answers, and comments from their sites.</li>
<li>
<a href="https://www.wikipedia.org">Wikipedia</a> provides <a href="https://www.mediawiki.org/wiki/API:Main_page#Uses_for_the_MediaWiki_Action_API">a public API</a> for retrieving content, including <a href="https://www.mediawiki.org/wiki/API:Users">individial contributor data</a>.</li>
<li>
<a href="https://www.semanticscholar.org">Semantic Scholar</a> is a website for navigating academic literature. It offers <a href="https://www.semanticscholar.org/product/api">a public API</a> for accessing abstracts, references, citations, and other information about academic publications. The API also allows access to their contextualized semantic embeddings of publications (see <a href="contextualized-embeddings.html"><span>Chapter&nbsp;19</span></a>). Obtaining an API key requires a simple registration.</li>
<li>Like Semantic Scholar, <a href="https://core.ac.uk/services/dataset">CORE</a> offers access to full text articles and metadata for open access research papers. Obtaining access requires a simple registration.</li>
<li>Facebook advertises a <a href="https://fort.fb.com/researcher-apis">research-oriented API</a>, which requires registration.</li>
<li>Mastodon is not the only open source, decentralized social media platform with an API. <a href="https://the-federation.info">There are many</a>, though most are small.</li>
</ul>
<p>To access one of these APIs through R, we recommend using the <a href="https://httr2.r-lib.org"><code>httr2</code></a> package. Most APIs send data in JSON format. As we mentioned in <a href="corpora.html"><span>Chapter&nbsp;8</span></a>, a JSON file is like a list in R, but formatted slightly differently. The <code>httr2</code> package also has functions for converting JSON to R objects. In the example below, we write a function to retrieve all questions with a particular tag from a particular site on StackExchange, and format them as a tibble.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://httr2.r-lib.org">httr2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># StackExchange API search endpoint</span></span>
<span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr2.r-lib.org/reference/request.html">request</a></span><span class="op">(</span><span class="st">"https://api.stackexchange.com/2.2/search?"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to retrieve posts with a given tag</span></span>
<span><span class="va">get_tagged_posts</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span>, <span class="va">...</span>,</span>
<span>                             <span class="co"># default params</span></span>
<span>                             <span class="va">site</span> <span class="op">=</span> <span class="st">"stackoverflow"</span>,</span>
<span>                             <span class="va">pagesize</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                             <span class="va">user</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                             <span class="va">order</span> <span class="op">=</span> <span class="st">"desc"</span>,</span>
<span>                             <span class="va">sort</span> <span class="op">=</span> <span class="st">"activity"</span>,</span>
<span>                             <span class="va">page</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># define request params</span></span>
<span>  <span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    <span class="va">...</span>,</span>
<span>    order <span class="op">=</span> <span class="va">order</span>,</span>
<span>    sort <span class="op">=</span> <span class="va">sort</span>,</span>
<span>    tagged <span class="op">=</span> <span class="va">tag</span>,</span>
<span>    site <span class="op">=</span> <span class="va">site</span>,</span>
<span>    pagesize <span class="op">=</span> <span class="va">pagesize</span>,</span>
<span>    page <span class="op">=</span> <span class="va">page</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># add user agent (this is polite for APIs)</span></span>
<span>  <span class="va">req</span> <span class="op">&lt;-</span> <span class="va">endpoint</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_user_agent.html">req_user_agent</a></span><span class="op">(</span><span class="va">user</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># add query parameters</span></span>
<span>  <span class="va">req</span> <span class="op">&lt;-</span> <span class="va">req</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_url.html">req_url_query</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">params</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># perform request + convert to list</span></span>
<span>  <span class="va">resp</span> <span class="op">&lt;-</span> <span class="va">req</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/req_perform.html">req_perform</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://httr2.r-lib.org/reference/resp_body_raw.html">resp_body_json</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># warn the user if API gave a "backoff" message, </span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">backoff</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">"Received backoff request from API."</span>,</span>
<span>            <span class="st">"Wait at least "</span>, <span class="va">resp</span><span class="op">$</span><span class="va">backoff</span>, <span class="st">" seconds"</span>,</span>
<span>            <span class="st">" before trying again!"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Convert list to tibble,</span></span>
<span>  <span class="co"># keeping only relevant variables</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">resp</span><span class="op">$</span><span class="va">items</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">title</span></span>
<span>      <span class="op">)</span>,</span>
<span>    is_answered <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">resp</span><span class="op">$</span><span class="va">items</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">is_answered</span></span>
<span>      <span class="op">)</span>,</span>
<span>    view_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">resp</span><span class="op">$</span><span class="va">items</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">view_count</span></span>
<span>      <span class="op">)</span>,</span>
<span>    creation_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">resp</span><span class="op">$</span><span class="va">items</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">creation_date</span></span>
<span>      <span class="op">)</span>,</span>
<span>    user_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">resp</span><span class="op">$</span><span class="va">items</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">user_id</span></span>
<span>      <span class="op">)</span>,</span>
<span>    link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span></span>
<span>      <span class="va">resp</span><span class="op">$</span><span class="va">items</span>, </span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">link</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># EXAMPLE USAGE: get 10 "teen"-related questions </span></span>
<span><span class="co"># from the "parenting" StackExchange site</span></span>
<span><span class="va">teen_posts</span> <span class="op">&lt;-</span> <span class="fu">get_tagged_posts</span><span class="op">(</span></span>
<span>  <span class="st">"teen"</span>, site <span class="op">=</span> <span class="st">"parenting"</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"Data Science for Psychology (ds4psych@gmail.com)"</span>,</span>
<span>  pagesize <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For further details on accessing APIs with <code>httr2</code> (including how to deal with rate limits), see <a href="https://httr2.r-lib.org/articles/wrapping-apis.html">the vignette</a>.</p>
<hr>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list">
<div id="ref-ashokkumar_pennebaker_2022" class="csl-entry" role="listitem">
Ashokkumar, A., &amp; Pennebaker, J. W. (2022). Tracking group identity through natural language within groups. <em>PNAS Nexus</em>, <em>1</em>(2), pgac022. <a href="https://doi.org/10.1093/pnasnexus/pgac022">https://doi.org/10.1093/pnasnexus/pgac022</a>
</div>
<div id="ref-mosleh_etal_2021" class="csl-entry" role="listitem">
Mosleh, M., Pennycook, G., &amp; Arechar, A. (2021). Cognitive reflection correlates with behavior on twitter. <em>Nature Communications</em>, <em>12</em>. <a href="https://doi.org/10.1038/s41467-020-20043-0">https://doi.org/10.1038/s41467-020-20043-0</a>
</div>
<div id="ref-rosenbusch_etal_2019" class="csl-entry" role="listitem">
Rosenbusch, H., Evans, A. M., &amp; Zeelenberg, M. (2019). Multilevel emotion transfer on YouTube: Disentangling the effects of emotional contagion and homophily on video audiences. <em>Social Psychological and Personality Science</em>, <em>10</em>(8), 1028–1035. <a href="https://doi.org/10.1177/1948550618820309">https://doi.org/10.1177/1948550618820309</a>
</div>
<div id="ref-takhteyev_etal_2012" class="csl-entry" role="listitem">
Takhteyev, Y., Gruzd, A., &amp; Wellman, B. (2012). Geography of twitter networks. <em>Social Networks</em>, <em>34</em>(1), 73–81. https://doi.org/<a href="https://doi.org/10.1016/j.socnet.2011.05.006">https://doi.org/10.1016/j.socnet.2011.05.006</a>
</div>
<div id="ref-tufekci_2014" class="csl-entry" role="listitem">
Tufekci, Z. (2014). Big questions for social media big data: Representativeness, validity and other methodological pitfalls. <em>Proceedings of the 8th International Conference on Weblogs and Social Media, ICWSM 2014</em>, <em>8</em>. <a href="https://doi.org/10.1609/icwsm.v8i1.14517">https://doi.org/10.1609/icwsm.v8i1.14517</a>
</div>
<div id="ref-xiao_mensah_2022" class="csl-entry" role="listitem">
Xiao, L., &amp; Mensah, H. (2022). How does the thread level of a comment affect its perceived persuasiveness? A reddit study. In K. Arai (Ed.), <em>Intelligent computing</em> (pp. 800–813). Springer International Publishing.
</div>
<div id="ref-yadav_etal_2011" class="csl-entry" role="listitem">
Yadav, A., Phillips, M., Lundeberg, M., Koehler, M., Hilden, K., &amp; Dirkin, K. (2011). If a picture is worth a thousand words is video worth a million? Differences in affective and cognitive processing of video and text cases. <em>J. Computing in Higher Education</em>, <em>23</em>, 15–37. <a href="https://doi.org/10.1007/s12528-011-9042-y">https://doi.org/10.1007/s12528-011-9042-y</a>
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./corpora.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Corpus Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./scraping.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Web Scraping</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Data Science for Psychology was written by <a href="https://rimonim.github.io">Louis Teitelbaum</a> and <a href="https://almogsi.com">Almog Simchon</a>.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a> and is powered by <a href="https://www.netlify.com/">Netlify</a></div>
  </div>
</footer>


</body></html>