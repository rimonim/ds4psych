# Web APIs {#sec-apis}

```{r setup}
#| echo: false
#| include: false

source("_common.R")
```

In @sec-corpora, we listed numerous placed to find datasets online. The sorts of datasets discussed there are generally formatted as a .csv file---or something like it---which you can download directly to your computer and import into R using `read_csv()`. Lot's of online data, however, are not pre-packaged in this way. When datasets are very large or complex, or are being updated regularly, the hosts of the data will instead provide a **web API**.

You can think of web APIs as little programming languages that are written inside a URL (URLs are the things you write in the top of your web browser to tell it which web page you want to access). When you access your custom-written URL, the host will perform whatever computations are necessary to get you your data, and send it to you in the same way that it would send you a website.

Web APIs are sometimes difficult to use because each one works differently. Learning to use a new API can be like learning a new programming language. For this reason, web APIs sometimes have associated **wrappers**, packages that allow you to communicate with the API in a more familiar format.

In the first part of this chapter, we introduce the [`vosonSML` package](https://github.com/vosonlab/vosonSML), an R-friendly wrapper that provides easy access to the Reddit, Twitter, Mastadon, and YouTube APIs. At the end of the chapter, we will discuss web APIs that do not have a convenient wrapper in R.

## API Basic Concepts

-   **Requests:** Each time you visit a URL associated with an API, you are submitting a *request* for data.
-   **Endpoints:** Every API has at least one *endpoint*, a contact point for particular types of requests.
-   **Rate Limits:** Many APIs set limits on the number of requests you can make per minute (or per second). This is because processing requests costs time and money for the host. If you go beyond the rate limit, the API will return an error like *"429 Too Many Requests"*.
-   **Authentication:** Some APIs are not open to the public, instead requiring users to apply for access or pay for a subscription. When accessing these APIs, you need an *API key* or an *access token*. This is your password for the API.

### vosonSML

```{r}
library(vosonSML)
```

For accessing social media APIs with vosonSML, you only need two functions:

-   `Authenticate()` creates a credential object that contains any keys or access tokens needed to access a particular API. This credential object can be reused as long as your credentials don't change.
-   `Collect()` initiates a series of API requests and stores the results as a dataframe or list of dataframes.

vosonSML also provides tools for working with network data (i.e. the ways in which users or posts are connected to one another), but these will not be covered in this textbook.

## Reddit

Reddit [generated over 3 billion posts and comments in 2022](https://www.statista.com/statistics/1319008/reddit-content-created/). Many of these contain long-form text. And its API is free. These traits make it very useful to researchers.

Reddit content exists on three levels:

- **Communities**, called "subreddits" are spaces for users to post about a specific topic. Individual subreddits are referred to as "r/SUBREDDIT". For example, [r/dataisbeautiful](https://www.reddit.com/r/dataisbeautiful/) is for data visualizations, [r/NaturalLanguage](https://www.reddit.com/r/NaturalLanguage/) is for posts about natural language processing, and [r/SampleSize](https://www.reddit.com/r/SampleSize/) is a place to gather volunteer participants for surveys and polls. Communities are policed by _moderators_, users who can remove posts or ban other users from the community. 
- **Posts** are posted by users to a particular subreddit. Each post has a **title**, which is always text, and **content**, which can contain text, images, and videos.
- **Comments** are responses to posts, responses to responses to posts, responses to responses to responses to posts, etc. These are always text.

### The Reddit Algorithm

Reddit data are not representative samples of the global population. They are not even representative samples of Reddit users. This is partly due to the dynamics of the Reddit ranking algorithm, which gives precedent to viral content. The details of the algorithm are [no longer public](https://medium.com/hacking-and-gonzo/how-reddit-ranking-algorithms-work-ef111e33d0d9), but it is largely based on "upvotes" and "downvotes" from the community, and probably also incorporates the time since posting. The ranking system for comments is almost certainly different from the ranking system for posts. Reddit also has a "Karma" system, by which users who post popular content get subsequent content boosted. This creates an incentive system which is [sometimes exploited by the advertising industry](https://www.reddit.com/r/ModSupport/comments/162p502/why_is_reddit_doing_nothing_to_handle_the_obvious/). The bottom line: **Reddit posts are disproportionately viral**. To partially counteract this when gathering Reddit data, set the API to sort by recency (`sort = "new"`) rather than the default, "best" [@sec-reddit-threads].

### Demographics on Reddit

Although Reddit accounts are almost always anonymous, users sometimes publicize aspects of their identity in a normative format. The most common of these is the convention to record age and sex (or gender) in parentheses or square brackets. For example, a 25-year-old man might refer to himself as "me (25M)" or a 30-year-old woman might refer to herself as "myself [30F]". By extracting such patterns, information about the age and gender of users can be extracted. This information should be used with caution for three reasons: First, extracting demographic information of users can lead to ethical issues [see @sec-ethics]. Second, self-reporting of demographic information happens disproportionately in certain subreddits, which themselves can be demographically skewed. Third, many users have more than one account. Especially for sensitive topics of the sort where demographic information is relevant, users will often generate _throwaway accounts_ to disconnect their sensitive activity from their every-day use. Because of this, the average activity of users who identify themselves as "30F" is unlikely to be representative of the average overall activity of 30-year-old women.

### Threads {#sec-reddit-threads}

A post with all of its associated comments is called a _thread_. 

@xiao_mensah_2022

```{r}
# sort = "new"
```

### Communities

@ashokkumar_pennebaker_2022 used both experimental data and naturalistic data retrieved from the Reddit API (r/The_Donald and r/hillaryclinton)

```{r}

```

- r/depression, r/ SuicideWatch, r/bipolarreddit, and r/opiates,
- r/changemyview, r/IAmA, and r/ExplainLikeImFive
- r/politics

::: {.callout-tip icon="false"}
## Advantages of Reddit Data

-   **Diverse Communities:**
-   **Long-form Responses:**
-   **Anonymity:** Users can remain relatively anonymous, which might encourage more honest and open sharing of experiences.
:::

::: {.callout-important icon="false"}
## Disadvantages of Reddit Data

-   **Selection Bias:** Certain subreddits may attract specific demographics, leading to potential selection bias in the data.
-   **Limited Generalizability:** Findings from Reddit may not generalize to the broader population due to the specific demographics and interests of its user base.
:::

## Twitter

::: {.callout-tip icon="false"}
## Advantages of Twitter Data

-   **Hashtag Tracking:** Researchers can track specific hashtags related to psychological phenomena.
-   **Character Limit:**
:::

::: {.callout-important icon="false"}
## Disadvantages of Twitter Data

-   **Character Limit:** The character limit on tweets may limit the depth of responses and the ability to convey complex psychological experiences.
-   **Sampling Bias:** Twitter users may not be representative of the general population, leading to potential sampling bias.
-   **Limited Context:** Tweets may lack context, making it challenging to fully understand the meaning behind short messages.
:::

## Mastadon

Many servers have a theme based on a specific interest. It is also common for servers to be based around a particular locality, region, ethnicity, or country.

Twitter and Mastodon use hashtags to categorize and organize content. subreddits on Reddit, instances on Mastodon

On a standard Mastodon instance, these messages can include up to 500 text-based characters, greater than Twitter's 280-character limit.

Mastodon uses community-based moderation, in which each server can limit or filter out undesirable types of content, while Twitter uses a single, global policy on content moderation.

-   organized into servers for topic-specific *users*

```{r}

```

::: {.callout-tip icon="false"}
## Advantages of Mastadon Data

-   **Hashtag Tracking:** Researchers can track specific hashtags related to psychological phenomena.
-   **Character Limit:**
:::

::: {.callout-important icon="false"}
## Disadvantages of Mastadon Data

-   **Character Limit:** The character limit on tweets may limit the depth of responses and the ability to convey complex psychological experiences.
-   **Sampling Bias:** Twitter users may not be representative of the general population, leading to potential sampling bias.
-   **Limited Context:** Tweets may lack context, making it challenging to fully understand the meaning behind short messages.
-   MASTADON **Customization:** Users can choose or create instances with specific rules and communities, allowing for more targeted data collection.
-   MASTADON **Smaller User Base:** Mastodon has a smaller user base compared to major platforms, potentially limiting the diversity of data.
-   MASTADON **Less Visibility:** The decentralized nature may make it harder to discover relevant conversations or trends.
:::

## YouTube

```{r}

```

@rosenbusch_etal_2019

::: {.callout-tip icon="false"}
## Advantages of YouTube Data

-   
:::

::: {.callout-important icon="false"}
## Disadvantages of YouTube Data

-   
:::

## Other Web APIs {#sec-other-apis}

https://en.wikipedia.org/wiki/Comparison_of_microblogging_and_similar_services https://the-federation.info

-   Wikipedia (including user data)
-   Facebook
-   Semantic Scholar
-   [CORE](https://core.ac.uk/services/dataset)

------------------------------------------------------------------------
